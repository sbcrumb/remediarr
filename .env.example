########################################
# Remediarr Configuration (.env)
########################################

# ====== App / Server ======
APP_HOST=0.0.0.0
APP_PORT=8189
# INFO (default), DEBUG, WARNING, ERROR
LOG_LEVEL=INFO

# Optional: set during dev builds; otherwise we read VERSION file
# REMEDIARR_VERSION=dev-<short-sha>

# ====== Webhook security (optional; enforced ONLY if set) ======
# If set, verify HMAC signature from Jellyseerr (X-Jellyseerr-Signature: sha256=<hex>)
WEBHOOK_SHARED_SECRET=
# Or require a custom header/value pair (both must be non-empty to enable)
WEBHOOK_HEADER_NAME=
WEBHOOK_HEADER_VALUE=

# ====== Jellyseerr ======
JELLYSEERR_URL=http://jellyseerr:5055
JELLYSEERR_API_KEY=

# Try to auto-close issues after remediation? true/false
# (env key changed — use CLOSE_JELLYSEERR_ISSUES)
CLOSE_JELLYSEERR_ISSUES=true
# Optional message posted when auto-closing (no need to add "[Remediarr]")
JELLYSEERR_CLOSE_MESSAGE=Issue auto-closed after remediation. If anything’s still off, comment and I’ll take another pass.

# Acknowledge user comments before acting (not our own)
ACK_ON_COMMENT_CREATED=true

# ====== Sonarr ======
SONARR_URL=http://sonarr:8989
SONARR_API_KEY=
SONARR_HTTP_TIMEOUT=60

# ====== Radarr ======
RADARR_URL=http://radarr:7878
RADARR_API_KEY=
RADARR_HTTP_TIMEOUT=60

# ====== Keywords (comma-separated, case-insensitive) ======
# TV
TV_AUDIO_KEYWORDS=no audio,no sound,missing audio,audio issue,wrong language,not in english
TV_VIDEO_KEYWORDS=no video,video glitch,black screen,stutter,pixelation
TV_SUBTITLE_KEYWORDS=missing subs,no subtitles,bad subtitles,wrong subs,subs out of sync
TV_OTHER_KEYWORDS=buffering,playback error,corrupt file

# Movies
MOVIE_AUDIO_KEYWORDS=no audio,no sound,audio issue,wrong language,not in english
MOVIE_VIDEO_KEYWORDS=no video,video missing,bad video,broken video,black screen
MOVIE_SUBTITLE_KEYWORDS=missing subs,no subtitles,bad subtitles,wrong subs,subs out of sync
MOVIE_OTHER_KEYWORDS=buffering,playback error,corrupt file
MOVIE_WRONG_KEYWORDS=not the right movie,wrong movie,incorrect movie

# ====== Behavior toggles ======
# Mark the last grabbed release as failed before retrying (best-effort)
ENABLE_BLOCKLIST=true

# ====== Notifications (optional) ======
# Gotify
GOTIFY_URL=
GOTIFY_TOKEN=
# 1–10 (higher = more urgent)
GOTIFY_PRIORITY=5

# Apprise (Discord/Telegram/Slack/etc.)
# (env key changed — use APPRISE_URLS; comma-separate multiple)
APPRISE_URLS=
# Example:
# APPRISE_URLS=discord://webhook_id/webhook_token,https://hooks.slack.com/services/XXX/YYY/ZZZ

# ====== Verification windows (post-search “did it grab?”) ======
RADARR_VERIFY_GRAB_SEC=60
RADARR_VERIFY_POLL_SEC=5
SONARR_VERIFY_GRAB_SEC=60
SONARR_VERIFY_POLL_SEC=5
# Cooldown to prevent repeat actions on the same issue (seconds)
ACTION_COOLDOWN_SEC=120
# ====== Customizable messages (all auto-prefixed with "[Remediarr]") ======
# Placeholders you can use: {title} {season} {episode} {deleted} {keywords}
# `{keywords}` now renders bucketed lists like:
#   audio: ... | video: ... | subtitle: ... | wrong: ... | other: ...

# One-shot success comments (posted only after a new download is detected)
MSG_MOVIE_REPLACED_AND_GRABBED={title}: replaced file; new download grabbed. Closing this issue. If anything’s still off, comment and I’ll take another pass.
MSG_TV_REPLACED_AND_GRABBED={title} S{season:02d}E{episode:02d}: replaced file; new download grabbed. Closing this issue. If anything’s still off, comment and I’ll take another pass.
MSG_MOVIE_SEARCH_ONLY_GRABBED={title}: new download grabbed. Closing this issue. If anything’s still off, comment and I’ll take another pass.
MSG_TV_SEARCH_ONLY_GRABBED={title} S{season:02d}E{episode:02d}: new download grabbed. Closing this issue. If anything’s still off, comment and I’ll take another pass.

# Coaching (shown when no keywords matched)
# (Added {keywords} so the user sees exactly what will trigger automation.)
MSG_KEYWORD_COACH=Tip: include one of these keywords next time so I can repair this automatically: {keywords}.

# Fallback when we acted but couldn't verify a new GRAB within the window
MSG_AUTOCLOSE_FAIL=Action completed but I couldn’t verify a new grab in time. Please keep an eye on it.
