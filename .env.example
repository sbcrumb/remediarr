########################################
# Remediarr Configuration
# Copy this file to .env and customize for your environment
########################################

# ====== APPLICATION SETTINGS ======
# Host and port for the Remediarr web server
# Leave as 0.0.0.0 to accept connections from any IP (required for Docker)
APP_HOST=0.0.0.0

# Port for the web server - must match your Docker port mapping
# Default: 8189 (choose any available port)
APP_PORT=8189

# Logging verbosity: DEBUG, INFO, WARNING, ERROR
# DEBUG: Shows detailed processing info (useful for troubleshooting)
# INFO: Standard operational messages (recommended)
# WARNING: Only warnings and errors
# ERROR: Only errors
LOG_LEVEL=INFO

# Override version display (usually auto-detected from git/VERSION file)
# Only set this if you need to force a specific version string
# REMEDIARR_VERSION=1.0.0

# ====== WEBHOOK SECURITY (Optional) ======
# Enable webhook signature verification for enhanced security
# If set, Jellyseerr must send X-Jellyseerr-Signature header with HMAC-SHA256
# Generate with: openssl rand -hex 32
# Leave empty to disable signature verification
WEBHOOK_SHARED_SECRET=

# Alternative: require a custom header for authentication
# Both WEBHOOK_HEADER_NAME and WEBHOOK_HEADER_VALUE must be set to enable
# Example: X-Custom-Auth: my-secret-token
WEBHOOK_HEADER_NAME=
WEBHOOK_HEADER_VALUE=

# ====== SONARR INTEGRATION ======
# Sonarr base URL (include http:// or https://)
# Use container name if running in Docker: http://sonarr:8989
# Use localhost if running locally: http://localhost:8989
SONARR_URL=http://sonarr:8989

# Sonarr API key from Settings > General > Security
# Required for: finding TV shows, deleting episode files, triggering searches
SONARR_API_KEY=

# HTTP timeout for Sonarr API calls in seconds
# Increase if you have a slow Sonarr instance or large library
SONARR_HTTP_TIMEOUT=60

# ====== RADARR INTEGRATION ======
# Radarr base URL (include http:// or https://)
# Use container name if running in Docker: http://radarr:7878  
# Use localhost if running locally: http://localhost:7878
RADARR_URL=http://radarr:7878

# Radarr API key from Settings > General > Security
# Required for: finding movies, deleting movie files, triggering searches
RADARR_API_KEY=

# HTTP timeout for Radarr API calls in seconds
# Increase if you have a slow Radarr instance or large library  
RADARR_HTTP_TIMEOUT=60

# ====== JELLYSEERR INTEGRATION ======
# Jellyseerr base URL (include http:// or https://)
# Use container name if running in Docker: http://jellyseerr:5055
# Use localhost if running locally: http://localhost:5055
JELLYSEERR_URL=http://jellyseerr:5055

# Jellyseerr API key from Settings > General > API Key
# Required for: fetching issue details, posting comments, closing issues
JELLYSEERR_API_KEY=

# Automatically close issues after successful remediation
# true: Close issues after fixing and posting success comment (recommended)
# false: Only post comment, leave issue open for manual closure
JELLYSEERR_CLOSE_ISSUES=true

# Post comments when actions are taken
# true: Post comments explaining what was done (recommended)
# false: Take actions silently without commenting
JELLYSEERR_COMMENT_ON_ACTION=true

# ====== KEYWORD CONFIGURATION ======
# Customize which keywords trigger each action type
# Keywords are case-insensitive and matched as substrings
# Use comma-separated lists, no quotes needed

# TV Show - Audio Issues
# Triggers: Delete episode file + re-download
TV_AUDIO_KEYWORDS=no audio,no sound,missing audio,audio issue,wrong language,not in english,audio missing,sound missing

# TV Show - Video Issues  
# Triggers: Delete episode file + re-download
TV_VIDEO_KEYWORDS=no video,video glitch,black screen,stutter,pixelation,video missing,broken video,video issue

# TV Show - Subtitle Issues
# Triggers: Delete episode file + re-download
TV_SUBTITLE_KEYWORDS=missing subs,no subtitles,bad subtitles,wrong subs,subs out of sync,subtitle issue,no captions

# TV Show - Other Issues
# Triggers: Delete episode file + re-download  
TV_OTHER_KEYWORDS=buffering,playback error,corrupt file,file corrupted,won't play,freezing

# Movie - Audio Issues
# Triggers: Delete movie files + new search
MOVIE_AUDIO_KEYWORDS=no audio,no sound,audio issue,wrong language,not in english,audio missing,sound missing

# Movie - Video Issues
# Triggers: Delete movie files + new search
MOVIE_VIDEO_KEYWORDS=no video,video missing,bad video,broken video,black screen,video issue,pixelated

# Movie - Subtitle Issues
# Triggers: Delete movie files + new search
MOVIE_SUBTITLE_KEYWORDS=missing subs,no subtitles,bad subtitles,wrong subs,subs out of sync,subtitle issue,no captions

# Movie - Other Issues (buffering, corruption, etc.)
# Triggers: Delete movie files + new search
MOVIE_OTHER_KEYWORDS=buffering,playback error,corrupt file,file corrupted,won't play,freezing

# Movie - Wrong Movie Downloaded
# Triggers: Delete movie files + new search (with optional digital release check)
MOVIE_WRONG_KEYWORDS=wrong movie,incorrect movie,not the right movie,this is not,different movie

# ====== BEHAVIOR SETTINGS ======
# Prevent repeat actions on the same issue for this many seconds
# Protects against webhook loops and spam
# 90 seconds is usually sufficient for most operations to complete
REMEDIARR_ISSUE_COOLDOWN_SEC=90

# Optional: Only search for new movies if they have a digital release
# Requires TMDB_API_KEY to check release dates
# true: Skip search if movie hasn't been digitally released yet
# false: Always search regardless of release status
SEARCH_ONLY_IF_DIGITAL_RELEASE=false

# TMDB API key for digital release checking (optional)
# Get free API key from: https://www.themoviedb.org/settings/api
# Only needed if SEARCH_ONLY_IF_DIGITAL_RELEASE=true
TMDB_API_KEY=

# ====== NOTIFICATION SETTINGS ======
# Send notifications when actions are taken (optional)

# Gotify Push Notifications
# Self-hosted notification server: https://gotify.net/
GOTIFY_URL=
GOTIFY_TOKEN=
# Priority level 1-10 (higher = more urgent, triggers different sounds/alerts)
GOTIFY_PRIORITY=5

# Apprise Notifications (Discord, Slack, Telegram, Email, etc.)
# Supports 80+ notification services: https://github.com/caronc/apprise
# Multiple URLs separated by commas
# Examples:
#   Discord: discord://webhook_id/webhook_token
#   Slack: slack://TokenA/TokenB/TokenC/Channel
#   Telegram: tgram://bottoken/ChatID
#   Email: mailto://user:pass@smtp.server.com?to=recipient@domain.com
APPRISE_URLS=

# ====== CUSTOM MESSAGES ======
# Customize the messages Remediarr posts (optional)
# All messages are automatically prefixed with "[Remediarr]"
# Available placeholders: {title} {season} {episode} {deleted}

# Success message for movies after file replacement and new download
MSG_MOVIE_SUCCESS={title}: replaced file; new download grabbed. Closing this issue. If anything's still off, comment and I'll take another pass.

# Success message for TV episodes after file replacement and new download  
MSG_TV_SUCCESS={title} S{season:02d}E{episode:02d}: replaced file; new download grabbed. Closing this issue. If anything's still off, comment and I'll take another pass.

# Message when action completed but issue couldn't be auto-closed
MSG_AUTOCLOSE_FAIL=Action completed but I couldn't auto-close this issue. Please close it once you verify it's fixed.

# ====== ADVANCED SETTINGS ======
# These settings are for advanced users and rarely need changing

# Custom bot prefix for comments (changing this may break loop detection)
# JELLYSEERR_BOT_COMMENT_PREFIX=[Remediarr]

# HTTP retry settings for external API calls
# HTTP_MAX_RETRIES=3
# HTTP_RETRY_BACKOFF=2.0

# ====== STARTUP HEALTH CHECK SETTINGS ======
# Health check retry configuration for startup
# When Remediarr starts, it checks if Sonarr and Radarr are accessible
# These settings control retry behavior if services aren't ready yet

# Number of retry attempts for startup health checks
# Useful when services start in different order (Remediarr before Sonarr/Radarr)
# Set to 0 to disable retries (fail immediately if service unavailable)
STARTUP_HEALTH_CHECK_RETRIES=3

# Seconds to wait between health check retry attempts
# Increase if your services take longer to become ready
STARTUP_HEALTH_CHECK_DELAY=10

########################################
# EXAMPLE CONFIGURATIONS
########################################

# === BASIC SETUP ===
# Minimal configuration for getting started:
# SONARR_URL=http://sonarr:8989  
# SONARR_API_KEY=abc123
# RADARR_URL=http://radarr:7878
# RADARR_API_KEY=def456
# JELLYSEERR_URL=http://jellyseerr:5055
# JELLYSEERR_API_KEY=ghi789

# === SECURE SETUP ===
# Add webhook security:
# WEBHOOK_SHARED_SECRET=your-32-char-hex-secret
# (Plus all basic settings above)

# === FULL FEATURED ===
# Everything enabled with notifications:
# (All basic settings)
# WEBHOOK_SHARED_SECRET=your-secret
# GOTIFY_URL=https://gotify.yourdomain.com
# GOTIFY_TOKEN=your-gotify-token
# APPRISE_URLS=discord://webhook_id/webhook_token
# LOG_LEVEL=INFO

########################################
# TROUBLESHOOTING
########################################

# Issue: "Missing tvdbId/season/episode" errors
# Solution: Verify Jellyseerr webhook payload includes all template variables
#          Check that issues are reported with season/episode information

# Issue: Actions not working
# Solution: Set LOG_LEVEL=DEBUG and check logs for API errors
#          Verify API keys have correct permissions
#          Ensure Sonarr/Radarr can access media files

# Issue: Webhook loops
# Solution: Only enable "Issue Reported" in Jellyseerr webhook settings
#          Don't enable "Issue Comment" or other event types

# Issue: Issues not closing automatically
# Solution: Some Jellyseerr versions don't support auto-close API
#          Set JELLYSEERR_CLOSE_ISSUES=false to disable attempts

# Issue: Keywords not matching
# Solution: Check keyword spelling and case (keywords are case-insensitive)
#          Add custom keywords to relevant *_KEYWORDS variables
#          Enable DEBUG logging to see keyword matching process